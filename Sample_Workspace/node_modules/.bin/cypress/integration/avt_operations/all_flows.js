require('cypress-downloadfile/lib/downloadFileCommand')

import 'cypress-file-upload'

describe('Download Demo', function () {

    it('Visit AVT site.', () => {
        cy.visit('https://avt-test.azurewebsites.net/new')
    })

    it('Sign In', () => {
        cy.get('input[name=username]').type('avatar')
        cy.get('input[name=password]').type('7xtU3s@9')
        cy.contains('Sign In').click()
    })

    it('Add dialogues', () => {
        cy.contains('Add Talk Text').click()
        cy.get('textarea[id=talk-text]').type('Hello my name is Dennis Chambers!')
        cy.get('span[class=MuiButton-label]').last().click()

        cy.contains('Add Talk Text').click()
        cy.get('textarea[id=talk-text]').type('Hello Dennis, nice to meet you. My name is Tony Williams!')
        cy.get('span[class=MuiButton-label]').last().click()
    })

    it('Play dialogue', () => {
        cy.contains('Listen to Scenario').click()
    })

    //Add new avatar button is not clickable
    //it('Create English Male Avatar', () => {
        //cy.get('svg[class=MuiSvgIcon-root]').first().click()
        //cy.contains('Settings').click()
        //cy.get('main[class=jss10]').scrollIntoView({ offset: { top: 0, left: 0 } })
        //cy.get('button[type=button]').eq(5).click({force: true})
        //MuiTouchRipple-root
        //cy.get('span[class=button]').eq(5).click({force: true})

        //cy.contains(' Add New Speaker ').click()
        //cy.wait(1000)
        //cy.get('input[type=button]').first().click()
        //cy.get('input[type=text]').first().type('Hezekiah')
    //})
    it('Delete Created Avatars (If already exists)', () => {
        //call two times to ensure the buttons and elements are visible
        cy.contains('Settings').click()
        cy.contains('Settings').click()
        cy.contains('Hezekiah').click()
        cy.contains('Delete').click()
        cy.wait(200)
        cy.contains('Yes').click()
        cy.contains('Jeroboam').click()
        cy.contains('Delete').click()
        cy.wait(200)
        cy.contains('Yes').click()
    })

    it('Create 1st Avatar', () => {
        //call two times to ensure the buttons and elements are visible
        cy.contains('Settings').click()
        cy.contains('Settings').click()
        cy.get('main[class=jss10]').scrollIntoView({ offset: { top: 0, left: 0 } })
        cy.get('button[type=button]').eq(5).click({force: true})
        //cy.contains(' Add New Speaker ').click()
        cy.wait(1000)
        //cy.get('input[type=button]').first().click()
        cy.get('input[type=text]').first().type('Hezekiah')
        //.MuiSelect-nativeInput
        //cy.get('input[value=MuiSelect-nativeInput]').click()
        cy.contains('Save').click()
        cy.wait(200)
        //cy.contains('Settings').click()
        cy.contains('Yes').click()
    })

    it('Create 2nd Avatar', () => {
        //call two times to ensure the buttons and elements are visible
        cy.contains('Settings').click()
        cy.contains('Settings').click()
        cy.get('main[class=jss10]').scrollIntoView({ offset: { top: 0, left: 0 } })
        cy.get('button[type=button]').eq(5).click({force: true})
        //cy.contains(' Add New Speaker ').click()
        cy.wait(1000)
        //cy.get('input[type=button]').first().click()
        cy.get('input[type=text]').first().type('Jeroboam')
        //.MuiSelect-nativeInput
        //cy.get('input[value=MuiSelect-nativeInput]').click()
        cy.contains('Save').click()
        cy.wait(200)
        //cy.contains('Settings').click()
        cy.contains('Yes').click()
    })

    it('Verify if both avatars are created', () => {
        //call two times to ensure the buttons and elements are visible
        cy.contains('Settings').click()
        cy.contains('Settings').click()
        cy.contains('Hezekiah').should('exist')
        cy.contains('Jeroboam').should('exist')
    })

    it('Create New Scenario', () => {
        //call two times to ensure the buttons and elements are visible
        cy.contains('Home').click()
        cy.contains('New Project').click()
        cy.get('input[id=prefix-text]').focus().clear()
        cy.get('input[id=prefix-text]').type('MyScenario')
        cy.contains('Import Existing Scenario').click()

        //import from fixtures
        const filepath = 'files/GlennTalk'
        cy.get('input[type="file"]').attachFile(filepath)
    })

    it('Check if newly created avatar exists', () => {
        //call two times to ensure the buttons and elements are visible
        cy.contains('Cancel').click()

        cy.contains('Add Talk Text').click()
        cy.get('textarea[id=talk-text]').type('Hello my name is Dennis Chambers!')
        cy.get('span[class=MuiButton-label]').last().click()

        //check if created avatar exists
        cy.get('div[class=MuiSelect-root.MuiSelect-select.MuiSelect-selectMenu.MuiSelect-outlined.MuiInputBase-input.MuiOutlinedInput-input]').click()
        
    })

})